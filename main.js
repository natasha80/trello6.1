(()=>{"use strict";class e{constructor(e){this.name=e,this.id=null,this.draggable=!0}addCardCloseBlock(){const e=document.createElement("div");return e.classList.add("card-close-block"),e.innerHTML='<button class="task_delete-button">Х</button>',e}createNewCard(e,t,n){const l=document.createElement("li");l.classList.add("list-item"),l.draggable=!0,l.innerHTML=`<p>${e.name}</p>`,t.appendChild(l);const r=this.addCardCloseBlock();l.addEventListener("mouseover",(()=>{l.insertAdjacentElement("beforeEnd",r),r.addEventListener("click",(()=>{n.splice(e.id,1),l.remove()}))})),l.addEventListener("mouseleave",(()=>{l.removeChild(r)}))}}function t(e,t){e.forEach((e=>{e.addEventListener("dragstart",(e=>{e.target.classList.add("selected")})),e.addEventListener("dragend",(e=>{e.target.classList.remove("selected")})),t.forEach((e=>{e.addEventListener("dragover",(t=>{t.preventDefault();const n=document.querySelector(".selected"),l=t.target;if(!(n!==l&&l.classList.contains("list-item")))return;const r=function(e,t){const n=t.getBoundingClientRect();return e<n.y+n.height/2?t:t.nextElementSibling}(t.clientY,l);e.insertBefore(n,r)}))}))}))}const n=new class{createForm(){const e=document.createElement("form");return e.classList.add("add-card"),e.innerHTML=' <textarea name="card-title" class="card-title-field" rows = "5" placeholder="Enter a title for this card..."></textarea>\n            <div class="input-container">\n                <div class="input-block">\n                    <input type="submit" value="Add Card" class="input-add-card">\n                    <div class="close-btn">\n                    <button class="delete-button">Х</button>\n                    </div>\n                </div>\n                 </div>',e}closeForm(e,t,n){e.querySelector(".close-btn").addEventListener("click",(()=>{e.reset(),n.removeChild(e)}))}afterSubmit(e,t,n){e.reset(),n.removeChild(e)}addCardTitle(e){return e.querySelector(".card-title-field").value}},l=document.querySelectorAll(".add-card-container"),r=[];function d(t,n){const l=new e(t);r.push(l),r.forEach(((e,t)=>{e.id=t})),l.createNewCard(l,n,r)}l.forEach((e=>{e.addEventListener("click",(()=>{const l=e.closest(".list-container"),r=l.querySelector(".list"),a=n.createForm();l.appendChild(a),n.closeForm(a,e,l),a.addEventListener("submit",(c=>{c.preventDefault(),d(n.addCardTitle(a),r),n.afterSubmit(a,e,l);const s=document.querySelectorAll(".list");t(document.querySelectorAll(".list-item"),s)}))}))})),window.onbeforeunload=function(){const e=[];let t=document.querySelectorAll(".list-item:not(.elementary)"),n=document.querySelectorAll(".list");t.forEach((t=>{let l;for(l=0;l<n.length&&t.parentElement!==n.item(l);l++);let r={title:t.firstChild.textContent,list_index:l};e.push(r)})),localStorage.setItem("data",JSON.stringify(e))},window.addEventListener("DOMContentLoaded",(()=>{let e=null;try{e=JSON.parse(localStorage.getItem("data"))}catch(e){return alert(e),void console.log(e)}let n=document.querySelectorAll(".list");e.forEach((e=>{d(e.title,n[e.list_index])}));const l=document.querySelectorAll(".list");t(document.querySelectorAll(".list-item"),l)}))})();